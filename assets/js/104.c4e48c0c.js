(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{786:function(e,t,r){"use strict";r.r(t);var o=r(10),n=Object(o.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"react-fiber"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#react-fiber"}},[e._v("ğŸŒ™")]),e._v(" React fiber")]),e._v(" "),r("blockquote",[r("p",[r("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/37095662",target:"_blank",rel:"noopener noreferrer"}},[e._v("React Fiberæ¶æ„"),r("OutboundLink")],1)])]),e._v(" "),r("ul",[r("li",[e._v("React16.x ä¸ºä»€ä¹ˆè¦å¯¹ç”Ÿå‘½å‘¨æœŸé’©å­å¤§æ¢è¡€")])]),e._v(" "),r("p",[e._v("Reactå°†è™šæ‹ŸDOMçš„æ›´æ–°è¿‡ç¨‹åˆ’åˆ†ä¸¤ä¸ªé˜¶æ®µï¼Œreconcileré˜¶æ®µä¸commité˜¶æ®µã€‚reconcileré˜¶æ®µå¯¹åº”æ—©æœŸç‰ˆæœ¬çš„diffè¿‡ç¨‹ï¼Œcommité˜¶æ®µå¯¹åº”æ—©æœŸç‰ˆæœ¬çš„patchè¿‡ç¨‹ã€‚")]),e._v(" "),r("p",[e._v("ä¸€äº›è¿·ä½ Reactï¼Œå¦‚preactä¼šå°†å®ƒä»¬æ··åˆåœ¨ä¸€èµ·ï¼Œä¸€è¾¹diffä¸€è¾¹patch(å¹¸å¥½å®ƒä½¿ç”¨äº†Promise.thenæ¥ä¼˜åŒ–ï¼Œç¡®ä¿æ¯æ¬¡åªæ›´æ–°ä¸€ä¸ªç»„ä»¶) ã€‚")]),e._v(" "),r("p",[e._v("æœ‰äº›è¿·ä½ Reactåˆ™æ˜¯é€šè¿‡å‡å°‘ç§»åŠ¨è¿›è¡Œä¼˜åŒ–ï¼Œäºæ˜¯ç»å°½è„‘æ±ï¼Œç”¨ä¸Šå„ç§ç®—æ³•ï¼Œæœ€çŸ­ç¼–è¾‘è·ç¦»ï¼Œæœ€é•¿å…¬å…±å­åºåˆ—ï¼Œæœ€é•¿ä¸Šå‡å­åºåˆ—ã€‚ã€‚ã€‚")]),e._v(" "),r("p",[e._v("å…¶å®åŸºäºç®—æ³•çš„ä¼˜åŒ–æ˜¯ä¸€ç§ç»æœ›çš„ä¼˜åŒ–ï¼Œå°±ç±»ä¼¼ç›é›…æ–‡æ˜å› ä¸ºæ‰¾ä¸åˆ°é“œçŸ¿ä¸€ç›´åœç•™äºçŸ³å™¨æ—¶ä»£ï¼Œè¯ç”Ÿäº†ä¼Ÿå¤§çš„å·¥åŒ ç²¾ç¥æŠŠçŸ³å™¨æ‰“ç£¨å¾—ç¾ä¼¦ç¾å¥‚ã€‚")]),e._v(" "),r("p",[e._v("ä¹‹æ‰€ä»¥è¿™ä¹ˆè¯´ï¼Œå› ä¸ºdiffç®—æ³•éƒ½ç”¨äºç»„ä»¶çš„æ–°æ—§childrenæ¯”è¾ƒï¼Œchildrenä¸€èˆ¬ä¸ä¼šå‡ºç°è¿‡é•¿çš„æƒ…å†µï¼Œæœ‰ç‚¹å¤§ç‚®æ‰“èšŠå­ã€‚å†µä¸”å½“æˆ‘ä»¬çš„åº”ç”¨å˜å¾—éå¸¸åºå¤§ï¼Œé¡µé¢æœ‰ä¸Šä¸‡ä¸ªç»„ä»¶ï¼Œè¦diffè¿™ä¹ˆå¤šç»„ä»¶ï¼Œå†å“ç»çš„ç®—æ³•ä¹Ÿä¸èƒ½ä¿è¯æµè§ˆå™¨ä¸ä¼šç´¯è¶´ã€‚å› ä¸ºä»–ä»¬æ²¡æƒ³åˆ°æµè§ˆå™¨ä¹Ÿä¼šç´¯è¶´ï¼Œä¹Ÿæ²¡æœ‰æƒ³åˆ°è¿™æ˜¯ä¸€ä¸ªé•¿è·‘çš„é—®é¢˜ã€‚å¦‚æœæ˜¯100ç±³çŸ­è·‘ï¼Œæˆ–è€…1000ç±³ç«èµ›ï¼Œå½“ç„¶è¶Šå¿«è¶Šå¥½ã€‚å¦‚æœæ˜¯é©¬æ‹‰æ¾ï¼Œå°±éœ€è¦è€ƒè™‘åˆ°ä¿å­˜ä½“åŠ›äº†ï¼Œéœ€è¦æ³¨æ„ä¼‘æ¯äº†ã€‚æ€§èƒ½æ˜¯ä¸€ä¸ªç³»ç»Ÿæ€§çš„å·¥ç¨‹ã€‚")]),e._v(" "),r("p",[e._v("åœ¨æˆ‘ä»¬çš„ä»£ç é‡Œé¢ï¼Œä¼‘æ¯å°±æ˜¯æ£€æµ‹æ—¶é—´ç„¶åæ–­å¼€Fiberé“¾ã€‚")]),e._v(" "),r("p",[e._v("updateFiberAndViewé‡Œé¢å…ˆè¿›è¡ŒupdateViewï¼Œç”±äºèŠ‚ç‚¹çš„æ›´æ–°æ˜¯ä¸å¯æ§ï¼Œå› æ­¤å…¨éƒ¨æ›´æ–°å®Œï¼Œæ‰æ£€æµ‹æ—¶é—´ã€‚å¹¶ä¸”æˆ‘ä»¬å®Œå…¨ä¸ç”¨æ‹…å¿ƒupdateViewä¼šå‡ºé—®é¢˜ï¼Œå› ä¸ºupdateViewå®è´¨ä¸Šæ˜¯åœ¨batchedUpdatesä¸­ï¼Œé‡Œé¢æœ‰try catchã€‚è€Œæ¥ä¸‹æ¥æˆ‘ä»¬åŸºäºDFSæ›´æ–°èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½è¦checkæ—¶é—´ï¼Œè¿™ä¸ªè¿‡ç¨‹å…¶å®å¾ˆå®³æ€•å‡ºé”™çš„ï¼Œ å› ä¸ºç»„ä»¶åœ¨æŒ‚è½½è¿‡ç¨‹ä¸­ä¼šè°ƒä¸‰æ¬¡é’©å­/æ–¹æ³•ï¼ˆconstructor, componentWillMount, renderï¼‰ï¼Œ ç»„ä»¶åœ¨æ›´æ–°è¿‡ç¨‹ä¸­ä¼šè°ƒ4æ¬¡é’©å­ ï¼ˆcomponentWillReceiveProps, shouldUpdate, componentWillUpdateï¼‰, æ€»ä¸èƒ½æ¯ä¸ªæ–¹æ³•éƒ½ç”¨try catchåŒ…èµ·æ¥ï¼Œè¿™æ ·ä¼šæ€§èƒ½å¾ˆå·®ã€‚è€Œconstructor, renderæ˜¯ä¸å¯é¿å…çš„ï¼Œäºæ˜¯å¯¹ä¸‰ä¸ªwillXXXåŠ¨åˆ€äº†ã€‚")]),e._v(" "),r("p",[e._v("åœ¨æ—©æœŸç‰ˆæœ¬ä¸­ï¼ŒcomponentWillMountä¸componentWillReceivePropsä¼šåšå†…éƒ¨ä¼˜åŒ–ï¼Œæ‰§è¡Œå¤šæ¬¡setStateéƒ½ä¼šå»¶ååˆ°renderæ—¶è¿›è¡Œåˆå¹¶å¤„ç†ã€‚å› æ­¤ç”¨æˆ·å°±è‚†æ„setStateäº†ã€‚è¿™äº›willXXXè¿˜å¯ä»¥è®©ç”¨æˆ·ä»»æ„æ“ä½œDOMã€‚ æ“ä½œDOMä¼šå¯èƒ½reflowï¼Œè¿™æ˜¯å®˜æ–¹ä¸æ„¿æ„çœ‹åˆ°çš„ã€‚äºæ˜¯å®˜æ–¹æ¨å‡ºäº†getDerivedStateFromPropsï¼Œè®©ä½ åœ¨renderè®¾ç½®æ–°stateï¼Œä½ ä¸»è¦è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå®ƒå°±ä¸»åŠ¨å¸®ä½ setStateã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œä½ ä¸èƒ½æ“ä½œinstanceï¼Œè¿™å°±é˜»æ­¢äº†ä½ å¤šæ¬¡æ“ä½œsetStateã€‚ç”±äºæ²¡æœ‰instance,ä¹Ÿå°±æ²¡æœ‰http://instance.refs.xxxï¼Œä½ ä¹Ÿæ²¡æœ‰æœºä¼šæ“ä½œDOMäº†ã€‚è¿™æ ·ä¸€æ¥ï¼ŒgetDerivedStateFromPropsçš„é€»è¾‘åº”è¯¥ä¼šå¾ˆç®€å•ï¼Œè¿™æ ·å°±ä¸ä¼šå‡ºé”™ï¼Œä¸ä¼šå‡ºé”™ï¼Œå°±ä¸ä¼šæ‰“æ–­DFSè¿‡ç¨‹ã€‚")]),e._v(" "),r("p",[e._v("getDerivedStateFromPropså–ä»£äº†åŸæ¥çš„componentWillMountä¸componentWillReceivePropsæ–¹æ³•ï¼Œè€ŒcomponentWillUpdateæœ¬æ¥å°±æ˜¯å¯æœ‰å¯æ— ï¼Œä»¥å‰å®Œå…¨æ˜¯ä¸ºäº†å¯¹ç§°å¥½çœ‹ã€‚")]),e._v(" "),r("p",[e._v("åœ¨å³ä½¿åˆ°æ¥çš„å¼‚æ­¥æ›´æ–°ä¸­ï¼Œreconcileré˜¶æ®µå¯èƒ½æ‰§è¡Œå¤šæ¬¡ï¼Œæ‰æ‰§è¡Œä¸€æ¬¡commitï¼Œè¿™æ ·ä¹Ÿä¼šå¯¼è‡´willXXXé’©å­æ‰§è¡Œå¤šæ¬¡ï¼Œè¿åå®ƒä»¬çš„è¯­ä¹‰ï¼Œå®ƒä»¬çš„åºŸå¼ƒæ˜¯ä¸å¯é€†è½¬çš„ã€‚")]),e._v(" "),r("p",[e._v("åœ¨è¿›å…¥commié˜¶æ®µæ—¶ï¼Œç»„ä»¶å¤šäº†ä¸€ä¸ªæ–°é’©å­å«getSnapshotBeforeUpdateï¼Œå®ƒä¸commité˜¶æ®µçš„é’©å­ä¸€æ ·åªæ‰§è¡Œä¸€æ¬¡ã€‚")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/",target:"_blank",rel:"noopener noreferrer"}},[e._v("å¦‚æœåŠ è½½å¤±è´¥CLICK ME"),r("OutboundLink")],1),e._v(" "),r("iframe",{attrs:{importance:"low",height:"600",width:"100%;",scrolling:"no",title:"react lifecycle",src:"https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/",loading:"lazy",allowtransparency:"true",allowfullscreen:"true"}})]),e._v(" "),r("blockquote",[r("p",[r("a",{attrs:{href:"https://blog.shenfq.com/2020/react-%E6%9E%B6%E6%9E%84%E7%9A%84%E6%BC%94%E5%8F%98-%E4%BB%8E%E5%90%8C%E6%AD%A5%E5%88%B0%E5%BC%82%E6%AD%A5/#%E6%97%A7%E7%89%88%E6%9C%AC-setState-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90",target:"_blank",rel:"noopener noreferrer"}},[e._v("React æ¶æ„çš„æ¼”å˜ - ä»åŒæ­¥åˆ°å¼‚æ­¥"),r("OutboundLink")],1)]),e._v(" "),r("p",[r("a",{attrs:{href:"https://blog.shenfq.com/2020/react-%E6%9E%B6%E6%9E%84%E7%9A%84%E6%BC%94%E5%8F%98-%E4%BB%8E%E9%80%92%E5%BD%92%E5%88%B0%E5%BE%AA%E7%8E%AF/",target:"_blank",rel:"noopener noreferrer"}},[e._v("React æ¶æ„çš„æ¼”å˜ - ä»é€’å½’åˆ°å¾ªç¯"),r("OutboundLink")],1)]),e._v(" "),r("p",[r("a",{attrs:{href:"https://blog.shenfq.com/2020/react-%E6%9E%B6%E6%9E%84%E7%9A%84%E6%BC%94%E5%8F%98-%E6%9B%B4%E6%96%B0%E6%9C%BA%E5%88%B6/",target:"_blank",rel:"noopener noreferrer"}},[e._v("React æ¶æ„çš„æ¼”å˜ - æ›´æ–°æœºåˆ¶"),r("OutboundLink")],1)]),e._v(" "),r("p",[r("a",{attrs:{href:"https://blog.shenfq.com/2020/react-%E6%9E%B6%E6%9E%84%E7%9A%84%E6%BC%94%E5%8F%98-hooks-%E7%9A%84%E5%AE%9E%E7%8E%B0/",target:"_blank",rel:"noopener noreferrer"}},[e._v("React æ¶æ„çš„æ¼”å˜ - Hooks çš„å®ç°"),r("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);